{"version":3,"names":["createGitRepository","folder","loader","getLoader","execa","stdio","fail","cwd","succeed","start","version","JSON","parse","fs","readFileSync","path","join","e","logger","debug"],"sources":["../../../src/commands/init/createGitRepository.ts"],"sourcesContent":["import {getLoader, logger} from '@react-native-community/cli-tools';\nimport execa from 'execa';\nimport fs from 'fs';\nimport path from 'path';\n\nconst createGitRepository = async (folder: string) => {\n  const loader = getLoader();\n\n  try {\n    await execa('git', ['--version'], {stdio: 'ignore'});\n  } catch {\n    loader.fail('Unable to initialize Git repo. `git` not in $PATH.');\n    return;\n  }\n\n  try {\n    await execa('git', ['rev-parse', '--is-inside-work-tree'], {\n      stdio: 'ignore',\n      cwd: folder,\n    });\n    loader.succeed(\n      'New project is already inside of a Git repo, skipping git init.',\n    );\n    return;\n  } catch {}\n\n  loader.start('Initializing Git repository');\n\n  let version;\n\n  try {\n    version = JSON.parse(\n      fs.readFileSync(\n        path.join('node_modules/react-native/package.json'),\n        'utf8',\n      ),\n    ).version;\n  } catch {}\n\n  try {\n    await execa('git', ['init'], {cwd: folder});\n    await execa('git', ['branch', '-M', 'main'], {cwd: folder});\n    await execa('git', ['add', '.'], {cwd: folder});\n    await execa(\n      'git',\n      [\n        'commit',\n        '-m',\n        `Initial commit\\n\\n${\n          version ? 'Generated by react-native@' + version : ''\n        }`,\n      ],\n      {\n        cwd: folder,\n      },\n    );\n    loader.succeed();\n  } catch (e) {\n    loader.fail(\n      'Could not create an empty Git repository, see debug logs with --verbose',\n    );\n    logger.debug(e as string);\n  }\n};\n\nexport default createGitRepository;\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAwB;AAExB,MAAMA,mBAAmB,GAAG,MAAOC,MAAc,IAAK;EACpD,MAAMC,MAAM,GAAG,IAAAC,qBAAS,GAAE;EAE1B,IAAI;IACF,MAAM,IAAAC,gBAAK,EAAC,KAAK,EAAE,CAAC,WAAW,CAAC,EAAE;MAACC,KAAK,EAAE;IAAQ,CAAC,CAAC;EACtD,CAAC,CAAC,MAAM;IACNH,MAAM,CAACI,IAAI,CAAC,oDAAoD,CAAC;IACjE;EACF;EAEA,IAAI;IACF,MAAM,IAAAF,gBAAK,EAAC,KAAK,EAAE,CAAC,WAAW,EAAE,uBAAuB,CAAC,EAAE;MACzDC,KAAK,EAAE,QAAQ;MACfE,GAAG,EAAEN;IACP,CAAC,CAAC;IACFC,MAAM,CAACM,OAAO,CACZ,iEAAiE,CAClE;IACD;EACF,CAAC,CAAC,MAAM,CAAC;EAETN,MAAM,CAACO,KAAK,CAAC,6BAA6B,CAAC;EAE3C,IAAIC,OAAO;EAEX,IAAI;IACFA,OAAO,GAAGC,IAAI,CAACC,KAAK,CAClBC,aAAE,CAACC,YAAY,CACbC,eAAI,CAACC,IAAI,CAAC,wCAAwC,CAAC,EACnD,MAAM,CACP,CACF,CAACN,OAAO;EACX,CAAC,CAAC,MAAM,CAAC;EAET,IAAI;IACF,MAAM,IAAAN,gBAAK,EAAC,KAAK,EAAE,CAAC,MAAM,CAAC,EAAE;MAACG,GAAG,EAAEN;IAAM,CAAC,CAAC;IAC3C,MAAM,IAAAG,gBAAK,EAAC,KAAK,EAAE,CAAC,QAAQ,EAAE,IAAI,EAAE,MAAM,CAAC,EAAE;MAACG,GAAG,EAAEN;IAAM,CAAC,CAAC;IAC3D,MAAM,IAAAG,gBAAK,EAAC,KAAK,EAAE,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE;MAACG,GAAG,EAAEN;IAAM,CAAC,CAAC;IAC/C,MAAM,IAAAG,gBAAK,EACT,KAAK,EACL,CACE,QAAQ,EACR,IAAI,EACH,qBACCM,OAAO,GAAG,4BAA4B,GAAGA,OAAO,GAAG,EACpD,EAAC,CACH,EACD;MACEH,GAAG,EAAEN;IACP,CAAC,CACF;IACDC,MAAM,CAACM,OAAO,EAAE;EAClB,CAAC,CAAC,OAAOS,CAAC,EAAE;IACVf,MAAM,CAACI,IAAI,CACT,yEAAyE,CAC1E;IACDY,kBAAM,CAACC,KAAK,CAACF,CAAC,CAAW;EAC3B;AACF,CAAC;AAAC,eAEajB,mBAAmB;AAAA"}